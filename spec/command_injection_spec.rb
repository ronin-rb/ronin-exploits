require 'spec_helper'
require 'ronin/exploits/command_injection'

describe Ronin::Exploits::CommandInjection do
  it "must inherit from Ronin::Exploits::Exploit" do
    expect(described_class).to be < Ronin::Exploits::Exploit
  end

  it "must include Ronin::Exploits::Mixins::HasPayload" do
    expect(described_class).to include(Ronin::Exploits::Mixins::HasPayload)
  end

  describe ".payload_class" do
    subject { described_class }

    it "must be Ronin::Payloads::CommandPayload" do
      expect(subject.payload_class).to be(Ronin::Payloads::CommandPayload)
    end
  end

  describe ".exploit_type" do
    subject { described_class }

    it { expect(subject.exploit_type).to eq(:command_injection) }
  end
end
